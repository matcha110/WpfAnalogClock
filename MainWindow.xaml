<Window x:Class="WpfAnalogClock.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Analog Clock"
        Width="280" Height="360"
        MinWidth="140" MinHeight="180"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">

    <!-- ルート Grid -->
    <Grid x:Name="RootGrid"
          MouseLeftButtonDown="RootGrid_MouseLeftButtonDown"
          Margin="8">

        <!-- 右クリック用コンテキストメニュー -->
        <Grid.ContextMenu>
            <ContextMenu Opened="CtxMenu_Opened">
                <MenuItem x:Name="MiToggleAlarm"
                          Header="アラームを表示/隠す"
                          Click="Menu_ToggleAlarm_Click"/>
                <Separator/>
                <MenuItem x:Name="MiTopmost"
                          Header="最前面に固定"
                          IsCheckable="True"
                          Click="Menu_Topmost_Click"/>
                <Separator/>
                <MenuItem Header="サイズ">
                    <MenuItem x:Name="MiScale050" Header="x0.5"  IsCheckable="True" Tag="0.5"  Click="Menu_Scale_Click"/>
                    <MenuItem x:Name="MiScale075" Header="x0.75" IsCheckable="True" Tag="0.75" Click="Menu_Scale_Click"/>
                    <MenuItem x:Name="MiScale100" Header="x1.0（デフォルト）" IsCheckable="True" Tag="1.0"  Click="Menu_Scale_Click"/>
                    <MenuItem x:Name="MiScale125" Header="x1.25" IsCheckable="True" Tag="1.25" Click="Menu_Scale_Click"/>
                    <MenuItem x:Name="MiScale150" Header="x1.5"  IsCheckable="True" Tag="1.5"  Click="Menu_Scale_Click"/>
                </MenuItem>
            </ContextMenu>
        </Grid.ContextMenu>

        <!-- 画像レイヤ -->
        <Grid>
            <!-- 背景：時計盤 -->
            <Image x:Name="ImgFace"
                   Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="HighQuality"/>

            <!-- 時針 -->
            <Image x:Name="ImgHour"
                   Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="HighQuality"
                   RenderTransformOrigin="0.5,0.5">
                <Image.RenderTransform>
                    <RotateTransform x:Name="RtHour" Angle="0"/>
                </Image.RenderTransform>
            </Image>

            <!-- 分針 -->
            <Image x:Name="ImgMinute"
                   Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="HighQuality"
                   RenderTransformOrigin="0.5,0.5">
                <Image.RenderTransform>
                    <RotateTransform x:Name="RtMinute" Angle="0"/>
                </Image.RenderTransform>
            </Image>
        </Grid>

        <!-- 下部：アラームUI（右クリックで表示/非表示を切替） -->
        <Border x:Name="AlarmPanel"                                 
            VerticalAlignment="Bottom" Margin="0,12,0,0" Padding="10"
                Background="#1A000000" CornerRadius="12"
                Visibility="Collapsed">
            <!-- ← 初期は非表示 -->
            <StackPanel Orientation="Vertical">
                <!-- 現在時刻表示 -->
                <TextBlock x:Name="TxtNow"
                           Foreground="White"
                           FontSize="18"
                           Text="--:--"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,6"/>

                <!-- アラーム設定行 -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,6">
                    <TextBlock Text="アラーム (HH:mm):" Foreground="White" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBox x:Name="TxtAlarm"
                             Width="80"
                             MaxLength="5"
                             Text="07:00"
                             ToolTip="例) 07:00 / 18:30"
                             VerticalContentAlignment="Center"
                             Margin="0,0,8,0"/>
                    <CheckBox x:Name="ChkEnableAlarm"
                              Content="有効化"
                              Foreground="White"
                              VerticalAlignment="Center"
                              Checked="ChkEnableAlarm_Checked"
                              Unchecked="ChkEnableAlarm_Unchecked"/>
                </StackPanel>

                <!-- 停止ボタン行 -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,6">
                    <Button x:Name="BtnStop"
                            Content="アラーム停止"
                            Click="BtnStop_Click"
                            IsEnabled="False"
                            Padding="8,4"/>
                </StackPanel>

                <!-- ステータス表示 -->
                <TextBlock x:Name="TxtStatus"
                           Foreground="#DDD"
                           FontSize="12"
                           Text="アラーム未設定"
                           TextWrapping="Wrap"
                           Opacity="0.9"/>
            </StackPanel>
        </Border>

        <Grid Panel.ZIndex="9999">
            <Border HorizontalAlignment="Left"  VerticalAlignment="Stretch" Width="8"
                    Background="Transparent" Cursor="SizeWE"
                    MouseDown="Resize_Left_MouseDown"/>
            <Border HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="8"
                    Background="Transparent" Cursor="SizeWE"
                    MouseDown="Resize_Right_MouseDown"/>
            <Border HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="8"
                    Background="Transparent" Cursor="SizeNS"
                    MouseDown="Resize_Top_MouseDown"/>
            <Border HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="8"
                    Background="Transparent" Cursor="SizeNS"
                    MouseDown="Resize_Bottom_MouseDown"/>

            <Border HorizontalAlignment="Left"  VerticalAlignment="Top"    Width="16" Height="16"
                    Background="Transparent" Cursor="SizeNWSE"
                    MouseDown="Resize_TopLeft_MouseDown"/>
            <Border HorizontalAlignment="Right" VerticalAlignment="Top"    Width="16" Height="16"
                    Background="Transparent" Cursor="SizeNESW"
                    MouseDown="Resize_TopRight_MouseDown"/>
            <Border HorizontalAlignment="Left"  VerticalAlignment="Bottom" Width="16" Height="16"
                    Background="Transparent" Cursor="SizeNESW"
                    MouseDown="Resize_BottomLeft_MouseDown"/>
            <Border HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="16" Height="16"
                    Background="Transparent" Cursor="SizeNWSE"
                    MouseDown="Resize_BottomRight_MouseDown"/>
        </Grid>
    </Grid>
</Window>
